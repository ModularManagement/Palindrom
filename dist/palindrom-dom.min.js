var PalindromDOM=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t,n){var r=n(7),o=n(6);e.exports={JSONPatchQueue:r,JSONPatchQueueSynchronous:o,__esModule:!0}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(t){var r=n(3),o=n(8),i=n(0).JSONPatchQueueSynchronous,s=n(0).JSONPatchQueue,a=n(5),h=n(4),p=function(){function e(e,t){var n=t.replace(/^http/i,"ws");e.wsUrl=n}function t(e,t,n){function r(){o=h,i=0,s=!1,clearTimeout(a),a=null}var o,i,s,a,h=1e3,p=function(){0==i?(t(0),s=!1,o*=2,e()):(t(i),i-=1e3,setTimeout(p,1e3))};this.triggerReconnection=function(){s||(i=o,s=!0,p())},this.reconnectNow=function(){i=0,o=h},this.stopReconnecting=function(){r(),n()},r()}function n(e,t,n,r){var o,i;this.start=function(){o||(o=setTimeout(function(){this.notifySend(),e()}.bind(this),n))},this.notifySend=function(){clearTimeout(o),o=null,i||(i=setTimeout(function(){i=null,t()}.bind(this),r))},this.notifyReceive=function(){clearTimeout(i),i=null,this.start()},this.stop=function(){clearTimeout(o),o=null,clearTimeout(i),i=null}}function p(){this.start=this.stop=this.notifySend=this.notifyReceive=function(){}}function c(t,n,r,o,i,s,a,h){this.palindrom=t,this.remoteUrl=new URL(n,window.location.href),r&&e(this,this.remoteUrl.href),o&&(this.onReceive=o),i&&(this.onSend=i),s&&(this.onConnectionError=s),a&&(this.onFatalError=a),h&&(this.onStateChange=h);var p=this;Object.defineProperty(this,"useWebSocket",{get:function(){return r},set:function(t){return r=t,0==t?p._ws&&(p._ws.onclose=function(){p._ws=null},p._ws.close()):p.wsUrl||e(this,t),r}})}function l(e,t,n,r){return e.xhr(t,"application/json",n,function(t){r(t.responseText),e.useWebSocket&&e.webSocketUpgrade()})}function u(e){e._ws&&(e._ws.onclose=function(){},e._ws.close(),e._ws=null)}function f(e){this.apply=e}function d(e,t){e.heartbeat.stop(),t(function(t){var n=JSON.parse(t);e.reconnector.stopReconnecting(),e.queue.reset(e.obj,n),e.debug&&(e.remoteObj=t),e.observe(),e.onDataReady&&e.onDataReady.call(e,e.obj),e.heartbeat.start()})}function v(e){d(e,e.network.establish.bind(e.network))}function y(e){d(e,function(t){e.network.reestablish(e.queue.pending,t)})}function g(e){if("object"!=typeof e)throw new Error("Palindrom constructor requires an object argument.");if(!e.remoteUrl)throw new Error("remoteUrl is required");if(this.jsonpatch=e.jsonpatch||this.jsonpatch,this.debug=void 0==e.debug||e.debug,"obj"in e){if("object"!=typeof e.obj)throw new Error("'options.obj' is not an object");this.obj=e.obj}else this.obj={};this.jsonPatcherProxy=new o(this.obj);var r=function(){};if(this.isObjectProxified=!1,this.isObserving=!1,this.onLocalChange=e.onLocalChange,this.onRemoteChange=e.onRemoteChange,this.onPatchReceived=e.onPatchReceived||r,this.onPatchSent=e.onPatchSent||r,this.onSocketStateChanged=e.onSocketStateChanged||r,this.onConnectionError=e.onConnectionError||r,this.retransmissionThreshold=e.retransmissionThreshold||3,this.onReconnectionCountdown=e.onReconnectionCountdown||r,this.onReconnectionEnd=e.onReconnectionEnd||r,this.reconnector=new t(function(){y(this)}.bind(this),this.onReconnectionCountdown,this.onReconnectionEnd),e.pingIntervalS){const l=1e3*e.pingIntervalS;this.heartbeat=new n(this.ping.bind(this),this.handleConnectionError.bind(this),l,l)}else this.heartbeat=new p;this.network=new c(this,e.remoteUrl,e.useWebSocket||!1,this.handleRemoteChange.bind(this),this.onPatchSent.bind(this),this.handleConnectionError.bind(this),this.handleFatalError.bind(this),this.onSocketStateChanged.bind(this)),Object.defineProperty(this,"useWebSocket",{get:function(){return this.network.useWebSocket},set:function(e){this.network.useWebSocket=e}}),this.ignoreCache={},this.ignoreAdd=e.ignoreAdd||null,this.onDataReady=e.callback,e.localVersionPath?e.remoteVersionPath?this.queue=e.ot?new h(a.transform,[e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity):new s([e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity):this.queue=new i(e.localVersionPath,this.validateAndApplySequence.bind(this),e.purity):this.queue=new f(this.validateAndApplySequence.bind(this)),v(this)}function b(e,t,n,r){if("add"===r&&e.test(n))return t[n]=!0,!0;for(var o=n.split("/"),i="",s=1,a=o.length;s<a;s++)if(i+="/"+o[s],t[i])return!0;return!1}function w(e,t){var n=JSON.stringify(t);e.unobserve(),e.heartbeat.notifySend(),e.network.send(n),e.observe()}if(void 0===m)if("undefined"!=typeof window)var m=window;else var m={};var O=function(){};O.prototype={constructor:O,apply:function(e){e.addEventListener=O.prototype.addEventListener,e.hasEventListener=O.prototype.hasEventListener,e.removeEventListener=O.prototype.removeEventListener,e.dispatchEvent=O.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&n[e].indexOf(t)!==-1},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners,r=n[e];if(void 0!==r){var o=r.indexOf(t);o!==-1&&r.splice(o,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners,n=t[e.type];if(void 0!==n){e.target=this;for(var r=[],o=n.length,i=0;i<o;i++)r[i]=n[i];for(var i=0;i<o;i++)r[i].call(this,e)}}}},c.prototype.establish=function(e){l(this,this.remoteUrl.href,null,e)},c.prototype.reestablish=function(e,t){l(this,this.remoteUrl.href+"/reconnect",JSON.stringify(e),t)},c.prototype.send=function(e){var t=this;if(this.useWebSocket&&this._ws&&1===this._ws.readyState)this._ws.send(e),t.onSend(e,t._ws.url,"WS");else{var n=this.remoteUrl.href;this.xhr(n,"application/json-patch+json",e,function(e,r){t.onReceive(e.responseText,n,r)})}return this},c.prototype.onReceive=function(){},c.prototype.onSend=function(){},c.prototype.onStateChange=function(){},c.prototype.upgrade=function(e){},c.prototype.webSocketUpgrade=function(e){var t=this,n=new URL(this.remoteUrl.pathname,this.wsUrl).href;u(t),t._ws=new WebSocket(n),t._ws.onopen=function(r){t.onStateChange(t._ws.readyState,n),e&&e(r)},t._ws.onmessage=function(e){t.onReceive(e.data,t._ws.url,"WS")},t._ws.onerror=function(e){if(t.onStateChange(t._ws.readyState,n,e.data),t.useWebSocket){var r={statusText:"WebSocket connection could not be made.",readyState:t._ws.readyState,url:n};t.onFatalError(r,n,"WS")}},t._ws.onclose=function(e){t.onStateChange(t._ws.readyState,n,null,e.code,e.reason);var r={statusText:"WebSocket connection closed.",readyState:t._ws.readyState,url:n,statusCode:e.code,reason:e.reason};e.reason?t.onFatalError(r,n,"WS"):t.onConnectionError()}},c.prototype.changeState=function(e){var t=this;return this.xhr(e,"application/json-patch+json",null,function(n,r){t.onReceive(n.responseText,e,r)},!0)},c.prototype.setRemoteUrl=function(e){if(this.remoteUrlSet&&this.remoteUrl&&this.remoteUrl!=e)throw new Error("Session lost. Server replied with a different session ID that was already set. \nPossibly a server restart happened while you were working. \nPlease reload the page.\n\nPrevious session ID: "+this.remoteUrl+"\nNew session ID: "+e);this.remoteUrlSet=!0,this.remoteUrl=new URL(e,this.remoteUrl)},c.prototype.handleResponseHeader=function(e){var t=e.getResponseHeader("X-Location")||e.getResponseHeader("Location");t&&this.setRemoteUrl(t)},c.prototype.xhr=function(e,t,n,r,o){var i=this,s=new XMLHttpRequest,a="GET";return s.onload=function(){var t=this;i.handleResponseHeader(t),t.status>=400&&t.status<=599?i.onFatalError({statusCode:t.status,statusText:t.statusText,reason:t.responseText},e,a):r&&r.call(i.palindrom,t,a)},s.onerror=i.onConnectionError.bind(i),n?(a="PATCH",s.open(a,e,!0),s.setRequestHeader("Content-Type","application/json-patch+json")):s.open(a,e,!0),t&&s.setRequestHeader("Accept",t),i.remoteUrl&&o&&s.setRequestHeader("X-Referer",i.remoteUrl.pathname),i.onSend(n,e,a),s.send(n),s},f.prototype.send=function(e){return e},f.prototype.receive=function(e,t){this.apply(e,t)},f.prototype.reset=function(e,t){var n=[{op:"replace",path:"",value:t}];this.apply(e,n)},g.prototype=Object.create(O.prototype);var P=function(e,t){var n;if(ErrorEvent.prototype.initErrorEvent){var r=document.createEvent("ErrorEvent");r.initErrorEvent("error",!0,!0,t.message,"",""),Object.defineProperty(r,"error",{value:t})}else n=new ErrorEvent("error",{bubbles:!0,cancelable:!0,error:t});e.dispatchEvent(n)};return g.prototype.jsonpatch=r,g.prototype.ping=function(){w(this,[])},g.prototype.observe=function(){this.isObjectProxified?this.jsonPatcherProxy.switchObserverOn():(this.obj=this.jsonPatcherProxy.observe(!0,this.filterChangedCallback.bind(this)),this.isObjectProxified=!0),this.isObserving=!0},g.prototype.unobserve=function(){this.jsonPatcherProxy&&this.jsonPatcherProxy.switchObserverOff(),this.isObserving=!1},g.prototype.filterChangedCallback=function(e){var t=[e];this.filterIgnoredPatches(t),t.length&&this.handleLocalChange(t)},g.prototype.filterIgnoredPatches=function(e){if(this.ignoreAdd)for(var t=0,n=e.length;t<n;t++)b(this.ignoreAdd,this.ignoreCache,e[t].path,e[t].op)&&(e.splice(t,1),n--,t--);return e},g.prototype.handleLocalChange=function(e){this.debug&&this.validateSequence(this.remoteObj,e),w(this,this.queue.send(e)),this.onLocalChange&&this.onLocalChange(e)},g.prototype.validateAndApplySequence=function(e,t){this.unobserve();try{var n=this.jsonpatch.apply(e,t,this.debug)}catch(e){if(this.debug)return e.message="Incoming patch validation error: "+e.message,void P(this,e);throw e}var r=this;t.forEach(function(e){if(""===e.path){var n=JSON.stringify(t);n.length>103&&(n=n.substring(0,100)+"..."),r.showWarning("Server pushed patch that replaces the object root",n)}}),this.observe(),this.onRemoteChange&&(console.warn("Palindrom.onRemoteChange is deprecated, please use patch-applied event instead."),this.onRemoteChange(t,n)),this.dispatchEvent(new CustomEvent("patch-applied",{bubbles:!0,cancelable:!0,detail:{patches:t,results:n}}))},g.prototype.validateSequence=function(e,t){var n=this.jsonpatch.validate(t,e);n&&(n.message="Outgoing patch validation error: "+n.message,P(this,n))},g.prototype.handleConnectionError=function(){this.heartbeat.stop(),this.reconnector.triggerReconnection()},g.prototype.handleFatalError=function(e,t,n){this.heartbeat.stop(),this.reconnector.stopReconnecting(),this.onConnectionError&&this.onConnectionError(e,t,n)},g.prototype.reconnectNow=function(){this.reconnector.reconnectNow()},g.prototype.showWarning=function(e,t){this.debug&&m.console&&console.warn&&(t&&(e+=" ("+t+")"),console.warn("Palindrom warning: "+e))},g.prototype.handleRemoteChange=function(e,t,n){this.heartbeat.notifyReceive();var r=JSON.parse(e||"[]");0!==r.length&&(this.onPatchReceived&&this.onPatchReceived(e,t,n),this.isObserving&&(this.queue.receive(this.obj,r),this.queue.pending&&this.queue.pending.length&&this.queue.pending.length>this.retransmissionThreshold&&this.queue.pending.forEach(w.bind(null,this)),this.debug&&(this.remoteObj=JSON.parse(JSON.stringify(this.obj)))))},m.Puppet=g,g}();e.exports=p,e.exports.default=p,e.exports.__esModule=!0}).call(t,n(1))},function(e,t,n){/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 1.1.8
 * (c) 2013 Joachim Wester
 * MIT license
 */
var r;!function(e){function t(e,n){switch(typeof e){case"undefined":case"boolean":case"string":case"number":return e===n;case"object":if(null===e)return null===n;if(h(e)){if(!h(n)||e.length!==n.length)return!1;for(var r=0,o=e.length;r<o;r++)if(!t(e[r],n[r]))return!1;return!0}var i=p(n),s=i.length;if(p(e).length!==s)return!1;for(var r=0;r<s;r++)if(!t(e[r],n[r]))return!1;return!0;default:return!1}}function n(e){for(var t,n=0,r=e.length;n<r;){t=e.charCodeAt(n);{if(!(t>=48&&t<=57))return!1;n++}}return!0}function r(e,t,r){for(var o,i,s=new Array(t.length),a=0,p=t.length;a<p;){o=t[a],a++;for(var d=o.path||"",v=d.split("/"),y=e,g=1,b=v.length,w=void 0;;){if(i=v[g],r&&void 0===w&&(void 0===y[i]?w=v.slice(0,g).join("/"):g==b-1&&(w=o.path),void 0!==w&&this.validator(o,a-1,e,w)),g++,void 0===i&&g>=b){s[a-1]=u[o.op].call(o,y,i,e);break}if(h(y)){if("-"===i)i=y.length;else{if(r&&!n(i))throw new f("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a-1,o.path,o);i=parseInt(i,10)}if(g>=b){if(r&&"add"===o.op&&i>y.length)throw new f("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a-1,o.path,o);s[a-1]=l[o.op].call(o,y,i,e);break}}else if(i&&i.indexOf("~")!=-1&&(i=i.replace(/~1/g,"/").replace(/~0/g,"~")),g>=b){s[a-1]=c[o.op].call(o,y,i,e);break}y=y[i]}}return s}function o(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function i(e){if(void 0===e)return!0;if("array"==typeof e||"object"==typeof e)for(var t in e)if(i(e[t]))return!0;return!1}function s(t,n,r,o){if("object"!=typeof t||null===t||h(t))throw new f("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,t,r);if(!c[t.op])throw new f("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,t,r);if("string"!=typeof t.path)throw new f("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,t,r);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new f('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",n,t,r);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new f("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new f("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&i(t.value))throw new f("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,t,r);if(r)if("add"==t.op){var s=t.path.split("/").length,a=o.split("/").length;if(s!==a+1&&s!==a)throw new f("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,t,r)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==o)throw new f("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,t,r)}else if("move"===t.op||"copy"===t.op){var p={op:"_get",path:t.from,value:void 0},l=e.validate([p],r);if(l&&"OPERATION_PATH_UNRESOLVABLE"===l.name)throw new f("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,t,r)}}function a(e,t){try{if(!h(e))throw new f("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)t=JSON.parse(JSON.stringify(t)),r.call(this,t,e,!0);else for(var n=0;n<e.length;n++)this.validator(e[n],n)}catch(e){if(e instanceof f)return e;throw e}}var h,p=function(e){if(h(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t},c={add:function(e,t){e[t]=this.value},remove:function(e,t){var n=e[t];return delete e[t],n},replace:function(e,t){var n=e[t];return e[t]=this.value,n},move:function(e,t,n){var o={op:"_get",path:this.path};r(n,[o]);var i=void 0===o.value?void 0:JSON.parse(JSON.stringify(o.value)),s={op:"_get",path:this.from};return r(n,[s]),r(n,[{op:"remove",path:this.from}]),r(n,[{op:"add",path:this.path,value:s.value}]),i},copy:function(e,t,n){var o={op:"_get",path:this.from};r(n,[o]),r(n,[{op:"add",path:this.path,value:o.value}])},test:function(e,n){return t(e[n],this.value)},_get:function(e,t){this.value=e[t]}},l={add:function(e,t){return e.splice(t,0,this.value),t},remove:function(e,t){return e.splice(t,1)[0]},replace:function(e,t){var n=e[t];return e[t]=this.value,n},move:c.move,copy:c.copy,test:c.test,_get:c._get},u={add:function(e){u.remove.call(this,e);for(var t in this.value)this.value.hasOwnProperty(t)&&(e[t]=this.value[t])},remove:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n],c.remove.call(this,e,n));return t},replace:function(e){var t=r(e,[{op:"remove",path:this.path}]);return r(e,[{op:"add",path:this.path,value:this.value}]),t[0]},move:c.move,copy:c.copy,test:function(e){return JSON.stringify(e)===JSON.stringify(this.value)},_get:function(e){this.value=e}};h=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=r;var f=function(e){function t(t,n,r,o,i){e.call(this,t),this.message=t,this.name=n,this.index=r,this.operation=o,this.tree=i}return o(t,e),t}(Error);e.JsonPatchError=f,e.validator=s,e.validate=a}(r||(r={}));var t,o;t.apply=r.apply,t.validate=r.validate,t.validator=r.validator,t.JsonPatchError=r.JsonPatchError,Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,o&&(t=void 0)},function(e,t,n){if(void 0===r)var r=n(0).JSONPatchQueue;var o=function(e,t,n,o){r.call(this,t,n,o),this.transform=e,this.pending=[]};o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype.ackLocalVersion=0,o.prototype.send=function(e){var t=e.slice(0);t.unshift({op:"test",path:this.remotePath,value:this.remoteVersion});var n=r.prototype.send.call(this,t);return this.pending.push(n),n},o.prototype.receive=function(e,t,n){var o=n||this.apply,i=this;return r.prototype.receive.call(this,e,t,function(e,t){var n=t.slice(0),r=n.shift().value,s=r-i.ackLocalVersion;i.ackLocalVersion=r,i.pending.splice(0,s),i.pending.length&&(n=i.transform(n,i.pending)),o(e,n)})},o.prototype.reset=function(e,t){this.ackLocalVersion=r.getPropertyByJsonPointer(t,this.localPath),this.pending=[],r.prototype.reset.call(this,e,t)},e.exports=o,e.exports.default=o,e.exports.__esModule=!0},function(e,t,n){/*!
 * https://github.com/Palindrom/JSONPatchOT
 * JSON-Patch-OT version: 1.0.1
 * (c) 2017 Tomek Wytrebowicz
 * MIT license
 */
var r=function(){function e(e,n,r){var o=e.substr(n.length),i=o.indexOf("/");i>-1||(i=o.length);var s=o.substr(0,i),a=o.substr(i);return t(s)&&s>r?n+(s-1)+a:e}function t(e){var t=~~Number(e);return String(t)===e&&t>=0}var n=n||{};n.transform=function(e,t){var n=[];n=n.concat.apply(n,t);var o=JSON.parse(JSON.stringify(e));return n.reduce(r,o)},n.transformAgainstSingleOp=function(e,t){};var r=function(e,t){if(void 0===t.value&&("add"===t.op||"replace"===t.op||"test"===t.op))throw new Error("'value' MUST be defined");if(void 0===t.from&&("copy"===t.op||"move"===t.op))throw new Error("'from' MUST be defined");if(o[t.op])if("function"==typeof o[t.op])o[t.op](t,e);else for(var n=e.length,r=0;r<n;){var i=e[r];r++,o[t.op][i.op]&&o[t.op][i.op](t,i)}return e},o={remove:function(n,r){for(var o,i=r.length,s=0;o=r[s];)("add"!==o.op&&"test"!==o.op||n.path!==o.path)&&(o.from&&(o.from===n.path||0===o.from.indexOf(n.path+"/"))||n.path===o.path||0===o.path.indexOf(n.path+"/"))&&(r.splice(s,1),i--,s--),s++;var a=n.path.lastIndexOf("/");if(a>-1){var h=n.path.substr(a+1),p=n.path.substr(0,a+1);if(t(h))for(i=r.length,s=0;s<i;)o=r[s],s++,0===o.path.indexOf(p)&&(o.path=e(o.path,p,h)),o.from&&0===o.from.indexOf(p)&&(o.from=e(o.from,p,h))}},replace:function(e,t){for(var n,r=0;n=t[r];)(n.from&&(n.from===e.path||0===n.from.indexOf(e.path+"/"))||0===n.path.indexOf(e.path+"/"))&&(t.splice(r,1),r--),r++}};return n}();e.exports=r,e.exports.default=r,e.exports.__esModule=!0},function(e,t,n){var r=function(e,t,n){this.waiting=[],this.versionPath=e,this.apply=t,this.purist=n};r.prototype.version=0,r.prototype.receive=function(e,t,n){var r=n||this.apply,o=t.slice(0);if(this.purist){o.shift()}var i=o.shift(),s=i.value;if(s<=this.version)throw new Error("Given version was already applied.");if(s==this.version+1)for(;o;)this.version++,r(e,o),o=this.waiting.shift();else this.waiting[s-this.version-2]=o},r.prototype.send=function(e){this.version++;var t=e.slice(0);return t.unshift({op:"replace",path:this.versionPath,value:this.version}),this.purist&&t.unshift({op:"test",path:this.versionPath,value:this.version-1}),t},r.getPropertyByJsonPointer=function(e,t){var n=t.split("/");""===n[0]&&n.shift();for(var r=e;n.length;){var o=n.shift().replace("~1","/").replace("~0","~");n.length&&(r=r[o])}return r[o]},r.prototype.reset=function(e,t){this.version=r.getPropertyByJsonPointer(t,this.versionPath),this.waiting=[];var n=[{op:"replace",path:"",value:t}];this.apply(e,n)},e.exports=r,e.exports.default=r,e.exports.__esModule=!0},function(e,t,n){var r=function(e,t,n){this.waiting=[],this.localPath=e[0],this.remotePath=e[1],this.apply=t,this.purist=n};r.prototype.localVersion=0,r.prototype.remoteVersion=0,r.prototype.receive=function(e,t,n){var r=n||this.apply,o=t.slice(0);if(this.purist){o.shift()}var i=o.shift(),s=i.value;if(s<=this.remoteVersion)throw new Error("Given version was already applied.");if(s==this.remoteVersion+1)for(;o;)this.remoteVersion++,r(e,o),o=this.waiting.shift();else this.waiting[s-this.remoteVersion-2]=o},r.prototype.send=function(e){this.localVersion++;var t=e.slice(0);return this.purist?t.unshift({op:"test",path:this.localPath,value:this.localVersion-1},{op:"replace",path:this.localPath,value:this.localVersion}):t.unshift({op:"replace",path:this.localPath,value:this.localVersion}),t},r.getPropertyByJsonPointer=function(e,t){var n=t.split("/");""===n[0]&&n.shift();for(var r=e;n.length;){var o=n.shift().replace("~1","/").replace("~0","~");n.length&&(r=r[o])}return r[o]},r.prototype.reset=function(e,t){this.remoteVersion=r.getPropertyByJsonPointer(t,this.remotePath),this.waiting=[];var n=[{op:"replace",path:"",value:t}];this.apply(e,n)},e.exports=r,e.exports.default=r,e.exports.__esModule=!0},function(e,t){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t){/*!
 * https://github.com/PuppetJS/JSONPatcherProxy
 * JSONPatcherProxy version: 0.0.2
 * (c) 2017 Starcounter 
 * MIT license
 */
var n=function(){function e(e){this.originalObject=e,this.cachedProxy=null,this.isRecording=!1,this.userCallback;var t=this;this.switchObserverOn=function(){t.defaultCallback=function(e){t.isRecording&&t.patches.push(e),t.userCallback&&t.userCallback(e)}},this.switchObserverOff=function(){t.defaultCallback=function(){}}}return e.deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},e.escapePathComponent=function(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")},e.prototype.generateProxyAtPath=function(t,n){if(!t)return t;var r=this;return new Proxy(t,{get:function(e,t,n){return"_isProxified"===t.toString()||Reflect.get(e,t,n)},set:function(t,o,i){var s=n+"/"+e.escapePathComponent(o.toString());if(i&&"object"==typeof i&&i._isProxified!==!0&&(i=r._proxifyObjectTreeRecursively(i,s)),void 0===i){if(t.hasOwnProperty(o))return Array.isArray(t)?r.defaultCallback({op:"replace",path:s,value:null}):r.defaultCallback({op:"remove",path:s}),Reflect.set(t,o,i);if(!Array.isArray(t))return Reflect.set(t,o,i)}return Array.isArray(t)&&!Number.isInteger(+o.toString())?Reflect.set(t,o,i):t.hasOwnProperty(o)?void 0===t[o]?(Array.isArray(t)?r.defaultCallback({op:"replace",path:s,value:i}):r.defaultCallback({op:"add",path:s,value:i}),Reflect.set(t,o,i)):(r.defaultCallback({op:"replace",path:s,value:i}),Reflect.set(t,o,i)):(r.defaultCallback({op:"add",path:s,value:i}),Reflect.set(t,o,i))},deleteProperty:function(t,o){return void 0!==t[o]&&r.defaultCallback({op:"remove",path:n+"/"+e.escapePathComponent(o.toString())}),Reflect.deleteProperty(t,o)}})},e.prototype._proxifyObjectTreeRecursively=function(t,n){for(var r in t)if(t.hasOwnProperty(r)&&"object"==typeof t[r]){var o=n+"/"+e.escapePathComponent(r);t[r]=this.generateProxyAtPath(t[r],o),this._proxifyObjectTreeRecursively(t[r],o)}return this.generateProxyAtPath(t,"")},e.prototype.proxifyObjectTree=function(e){this.switchObserverOff();var t=this._proxifyObjectTreeRecursively(e,"");return this.switchObserverOn(),t},e.prototype.observe=function(t,n){if(!t&&!n)throw new Error("You need to either record changes or pass a callback");return this.isRecording=t,n&&(this.userCallback=n),t&&(this.patches=[]),this.cachedProxy=this.proxifyObjectTree(e.deepClone(this.originalObject))},e.prototype.generate=function(){if(!this.isRecording)throw new Error("You should set record to true to get patches later");return this.patches.splice(0,this.patches.length)},e.prototype.unobserve=function(){return e.deepClone(this.cachedProxy)},e}();e.exports=n,e.exports.default=n}])},function(e,t,n){(function(t){var r=n(2),o=function(){var e=function(e){if("object"!=typeof e)throw new Error("PalindromDOM constructor requires an object argument.");if(!e.remoteUrl)throw new Error("remoteUrl is required");var t=e.callback;this.element=e.listenTo||document.body;var n=this.clickHandler.bind(this);this.historyHandler=this.historyHandler.bind(this),this.historyHandlerDeprecated=function(){console.warn("`puppet-redirect-pushstate` event is deprecated, please use `palindrom-redirect-pushstate`, if you're using `puppet-redirect`, please upgrade to `palindrom-redirect`"),this.historyHandler()}.bind(this),this.element.addEventListener("palindrom-redirect-pushstate",this.historyHandler),this.element.addEventListener("puppet-redirect-pushstate",this.historyHandlerDeprecated),e.callback=function(e){this.listen(),t&&t.call(this,e)},this.listen=function(){this.listening=!0,this.element.addEventListener("click",n),window.addEventListener("popstate",this.historyHandler),this.element.addEventListener("palindrom-redirect-pushstate",this.historyHandler),this.element.addEventListener("puppet-redirect-pushstate",this.historyHandlerDeprecated)},this.unlisten=function(){this.listening=!1,this.element.removeEventListener("click",n),window.removeEventListener("popstate",this.historyHandler),this.element.removeEventListener("palindrom-redirect-pushstate",this.historyHandler),this.element.removeEventListener("puppet-redirect-pushstate",this.historyHandlerDeprecated)},r.call(this,e)};if(e.prototype=Object.create(r.prototype),e.prototype.morphUrl=function(e){history.pushState(null,null,e),this.network.changeState(e)},e.prototype.clickHandler=function(t){if(!t.ctrlKey&&!t.metaKey&&2!=t.which){t.detail&&t.detail.target&&(t=t.detail);var n=t.target;if("A"!==n.nodeName)for(var r=0;r<t.path.length;r++)if("A"==t.path[r].nodeName){n=t.path[r];break}var o=n.href||n.getAttribute("href");o&&e.isApplicationLink(o)?(t.preventDefault(),t.stopPropagation(),this.morphUrl(o)):"submit"===n.type&&t.preventDefault()}},e.prototype.historyHandler=function(){this.network.changeState(location.href)},e.isApplicationLink=function(e){if("string"==typeof e){var t=document.createElement("A");t.href=e,""==t.host&&(t.href=t.href),e=t}return e.protocol==window.location.protocol&&e.host==window.location.host},void 0===t)var t=window;return t.PuppetDOM=e,t.Puppet=r,t.Palindrom=r,e}();e.exports=o,e.exports.default=o,e.exports.__esModule=!0}).call(t,n(1))}]);